orbs:
  codecov: circleci/codecov-clojure@0.0.4
  my-orb:
    executors:
      default:
        description: "CircleCI image for OpenJDK"
        docker:
        - image: circleci/openjdk

    commands:
      install:
        description: "Installs the nexus-platform-api and CLI script"
        parameters:
          nexus-platform-api-version:
            type: string
            default: "3.3.20181025-095610.1ce86ad"
          groovy-version:
            type: string
            default: "2.5.3"
        steps:
        - run: |
              curl http://central.maven.org/maven2/com/sonatype/nexus/nexus-platform-api/<< parameters.nexus-platform-api-version >>/nexus-platform-api-<< parameters.nexus-platform-api-version >>.jar -o nexus-platform-api.jar
              curl https://dl.bintray.com/groovy/maven/apache-groovy-binary-<<parameters.groovy-version>>.zip -o apache-groovy-binary.zip
              curl https://raw.githubusercontent.com/sonatype-nexus-community/circleci-nexus-orb/INT-1109_repository_groovy_wrapper/cli/src/main/groovy/NexusPublisher.groovy -o NexusPublisher.groovy
              pwd

      archive:
        steps:
        - run: echo "Archive command will start here"

    jobs:
      nexusjob:
        executor: default
        steps:
        - install

version: 2.1
workflows:
  main:
    jobs:
    - my-orb/nexusjob
